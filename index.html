<!DOCTYPE html>
<html lang="en">
  <!DOCTYPE html>
  <html lang="en">
  <head>
      <meta charset="UTF-8">
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <title>ë°¥ì„¼ìŠ¤</title>
      <style>
        /* ê¸°ë³¸ ìŠ¤íƒ€ì¼ */
        body {
            margin: 0;
            padding: 0;
            font-family: 'Arial', sans-serif;
            font-size: 18px;
            background: linear-gradient(rgba(0, 0, 0, 0.5), rgba(0, 0, 0, 0.5)),
                        url('img/bapsense_background.png') no-repeat center center / cover;
            color: #fff;
            display: flex;
            flex-direction: column;
            align-items: center;
            min-height: 100vh;
            box-sizing: border-box;
        }

        .header {
            width: 100%;
            text-align: center;
            padding: 20px;
            background-color: rgba(255, 255, 255, 0.8);
            border-radius: 15px;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
            margin-bottom: 20px;
        }
        .header p {
          font-size: 1.2rem;
          font-weight: bold;
          color: #333;
          margin: 0;
          line-height: 1.6;
        }
        .container {
            text-align: center;
            max-width: 500px;
            width: 90%;
            background-color: rgba(255, 255, 255, 0.8);
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
            display: none;
        }

        .container.active {
            display: block;
        }

        h1 {
            font-size: 1.5rem;
            color: #333;
            margin-bottom: 20px;
        }

        .options {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .option {
            padding: 15px 20px;
            font-size: 1rem;
            color: #fff;
            background-color: #4CAF50;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            text-align: center;
            transition: background-color 0.3s ease;
        }

        .option:hover {
            background-color: #45a049;
        }

        .option:active {
            background-color: #3e8e41;
        }

        .restaurant-list {
            text-align: left;
            color: #333;
        }

        .restaurant-item {
            margin-bottom: 15px;
            padding: 10px;
            background-color: rgba(255, 255, 255, 0.9);
            border-radius: 10px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
        }

        .restaurant-name {
            font-size: 1.2rem;
            font-weight: bold;
        }

        .restaurant-menu {
            font-size: 1rem;
            color: #555;
        }

        .restaurant-reason {
            font-size: 0.9rem;
            color: #777;
        }
    </style>
  </head>
  <div class="header">
    <p>ê³ ë¯¼ì€ ê·¸ë§Œ!! ë‹¹ì‹ ì˜ ê¸°ë¶„ê³¼ ìƒí™©ì— ë”°ë¼ ì ì ˆ~í•œ ë©”ë‰´ë¥¼ ì„¼ìŠ¤ìˆê²Œ ì¶”ì²œí•´ ì¤ë‹ˆë‹¤!!</p>
</div>
<div class="container step-1 active">
    <h1>ë‹¹ì‹ ì˜ ê¸°ë¶„ì€ ì–´ë–¤ê°€ìš”?</h1>
    <div class="options">
        <button class="option" onclick="selectMood('í–‰ë³µí•´ìš”')">í–‰ë³µí•´ìš” ğŸ˜Š</button>
        <button class="option" onclick="selectMood('ì§€ì³ìš”')">ì§€ì³ìš” ğŸ˜©</button>
        <button class="option" onclick="selectMood('í™”ë‚˜ìš”')">í™”ë‚˜ìš” ğŸ˜¡</button>
        <button class="option" onclick="selectMood('ìŠ¬í¼ìš”')">ìŠ¬í¼ìš” ğŸ˜¢</button>
    </div>
</div>
<div class="container step-2">
    <h1>ë‹¹ì‹ ì˜ ìƒí™©ì€ ì–´ë–¤ê°€ìš”?</h1>
    <div class="options">
        <button class="option" onclick="selectSituation('ê¸‰í•˜ê²Œ ë°¥ë¨¹ì–´ì•¼í•´ìš”')">ê¸‰í•˜ê²Œ ë°¥ë¨¹ì–´ì•¼í•´ìš” â±ï¸</button>
        <button class="option" onclick="selectSituation('ì‹œê°„ì´ ë„‰ë„‰í•˜ë„¤ìš”')">ì‹œê°„ì´ ë„‰ë„‰í•˜ë„¤ìš” ğŸ•°ï¸</button>
        <button class="option" onclick="selectSituation('í˜¼ë°¥í•˜ê³  ì‹¶ì–´ìš”')">í˜¼ë°¥í•˜ê³  ì‹¶ì–´ìš” ğŸ´</button>
        <button class="option" onclick="selectSituation('ì¹œêµ¬ë“¤ê³¼ í•¨ê»˜ì˜ˆìš”')">ì¹œêµ¬ë“¤ê³¼ í•¨ê»˜ì˜ˆìš” ğŸ‘¥</button>
    </div>
</div>
<div class="container step-3">
    <h1>ì¶”ì²œ ë§›ì§‘ ë¦¬ìŠ¤íŠ¸</h1>
    <div class="restaurant-list">
        <div class="restaurant-item">
            <div class="restaurant-name">ë§›ì§‘ 1: í–‰ë³µì‹ë‹¹</div>
            <div class="restaurant-menu">ì£¼ìš”ë©”ë‰´: ê¹€ì¹˜ì°Œê°œ, ì‚¼ê²¹ì‚´</div>
            <div class="restaurant-reason">ì¶”ì²œì´ìœ : ê°„í¸í•˜ê³  ë¹ ë¥´ê²Œ ë¨¹ì„ ìˆ˜ ìˆì–´ìš”!</div>
        </div>
        <div class="restaurant-item">
            <div class="restaurant-name">ë§›ì§‘ 2: ì—¬ìœ ë¡œìš´ ì •ì›</div>
            <div class="restaurant-menu">ì£¼ìš”ë©”ë‰´: ë¹„ë¹”ë°¥, ëœì¥ì°Œê°œ</div>
            <div class="restaurant-reason">ì¶”ì²œì´ìœ : ì—¬ìœ ë¡­ê²Œ ì‹œê°„ì„ ë³´ë‚¼ ìˆ˜ ìˆëŠ” ê³³ì…ë‹ˆë‹¤.</div>
        </div>
        <div class="restaurant-item">
            <div class="restaurant-name">ë§›ì§‘ 3: í˜¼ë°¥ì˜ ë‹¬ì¸</div>
            <div class="restaurant-menu">ì£¼ìš”ë©”ë‰´: ëˆê¹ŒìŠ¤, ìš°ë™</div>
            <div class="restaurant-reason">ì¶”ì²œì´ìœ : í˜¼ì ê°€ë„ ë¶€ë‹´ ì—†ëŠ” ë¶„ìœ„ê¸°ì…ë‹ˆë‹¤.</div>
        </div>
        <div class="restaurant-item">
            <div class="restaurant-name">ë§›ì§‘ 4: ì¹œêµ¬ë„¤ ê³ ê¹ƒì§‘</div>
            <div class="restaurant-menu">ì£¼ìš”ë©”ë‰´: ê³ ê¸°êµ¬ì´, ëƒ‰ë©´</div>
            <div class="restaurant-reason">ì¶”ì²œì´ìœ : ì¹œêµ¬ë“¤ê³¼ í•¨ê»˜ ê°€ê¸° ì¢‹ì€ ì¥ì†Œì…ë‹ˆë‹¤.</div>
        </div>
    </div>
</div>
</body>
</html>
<script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>

<script src="js/jquery-3.4.1.min.js"></script>    
<script type="application/javascript">
  var queryString = location.search;
  const urlParams = new URLSearchParams(queryString);
  const utm = urlParams.get("utm")

                  var ip = "null";
                  function getIP(json) {
                      try {
                            ip = json.ip;
                      } catch (e) {
              console.log(e)
                            ip = 'unknown';
                      }
                      return ip;
                  }
</script>
<script type="application/javascript" src="https://jsonip.com?format=jsonp&callback=getIP"></script>
<script>

    var mobile = 'desktop';
    if (/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)) {
      // true for mobile device
      mobile = 'mobile';
    }

    // Sam pading value to start with 0. eg: 01, 02, .. 09, 10, ..
    function padValue(value) {
      return (value < 10) ? "0" + value : value;
    }

    function getTimeStamp() { 
      const date = new Date();

      const year = date.getFullYear();
      const month = date.getMonth() + 1;
      const day = date.getDate();
      const hours = date.getHours();
      const minutes = date.getMinutes();
      const seconds = date.getSeconds();

      const formattedDate = `${padValue(year)}-${padValue(month)}-${padValue(day)} ${padValue(hours)}:${padValue(minutes)}:${padValue(seconds)}`;

      return formattedDate;
    }
// ì¿ í‚¤ì—ì„œ ê°’ì„ ê°€ì ¸ì˜¤ëŠ” í•¨ìˆ˜
				function getCookieValue(name) {
					const value = "; " + document.cookie;
					const parts = value.split("; " + name + "=");
					if (parts.length === 2) {
						return parts.pop().split(";").shift();
					}
				}

				// ì¿ í‚¤ì— ê°’ì„ ì €ì¥í•˜ëŠ” í•¨ìˆ˜
				function setCookieValue(name, value, days) {
					let expires = "";
					if (days) {
						const date = new Date();
						date.setTime(date.getTime() + (days * 24 * 60 * 60 * 1000));
						expires = "; expires=" + date.toUTCString();
					}
					document.cookie = name + "=" + (value || "") + expires + "; path=/";
				}

				function getUVfromCookie() {
					// 6ìë¦¬ ì„ì˜ì˜ ë¬¸ìì—´ ìƒì„±
					const hash = Math.random().toString(36).substring(2, 8).toUpperCase();
					// ì¿ í‚¤ì—ì„œ ê¸°ì¡´ í•´ì‹œ ê°’ì„ ê°€ì ¸ì˜´
					const existingHash = getCookieValue("user");
					// ê¸°ì¡´ í•´ì‹œ ê°’ì´ ì—†ìœ¼ë©´, ìƒˆë¡œìš´ í•´ì‹œ ê°’ì„ ì¿ í‚¤ì— ì €ì¥
					if (!existingHash) {
						setCookieValue("user", hash, 180); // ì¿ í‚¤ ë§Œë£Œì¼ì€ 6ê°œì›” 
						return hash;
					} else {
						// ê¸°ì¡´ í•´ì‹œ ê°’ì´ ìˆìœ¼ë©´, ê¸°ì¡´ ê°’ì„ ë°˜í™˜
						return existingHash;
					}
				}

				/* ìˆ˜ì • payload data -> id:getUVfromCookie() */

    var data = JSON.stringify(
                    {"id": getUVfromCookie(),
              "landingUrl":window.location.href, 
              "ip":ip, 
              "referer":document.referrer,
              "time_stamp":getTimeStamp(), 
              "utm":utm,
              "device":mobile}
              );
    function setVideoSize() {
      const vidWidth = 1920;
      const vidHeight = 1080;
      const windowWidth = window.innerWidth;
      const windowHeight = window.innerHeight;
      const tempVidWidth = windowHeight * vidWidth / vidHeight;
      const tempVidHeight = windowWidth * vidHeight / vidWidth;
      const newVidWidth = tempVidWidth > windowWidth ? tempVidWidth : windowWidth;
      const newVidHeight = tempVidHeight > windowHeight ? tempVidHeight : windowHeight;
      const tmVideo = $('#tm-video');

      tmVideo.css('width', newVidWidth);
      tmVideo.css('height', newVidHeight);
    }

    function openTab(evt, id) {
      $('.tm-tab-content').hide();
      $('#' + id).show();
      $('.tm-tab-link').removeClass('active');
      $(evt.currentTarget).addClass('active');
    }    

    function initPage() {
      let pageId = location.hash;

      if(pageId) {
        highlightMenu($(`.tm-page-link[href^="${pageId}"]`)); 
        showPage($(pageId));
      }
      else {
        pageId = $('.tm-page-link.active').attr('href');
        showPage($(pageId));
      }
    }

    function highlightMenu(menuItem) {
      $('.tm-page-link').removeClass('active');
      menuItem.addClass('active');
    }

    function showPage(page) {
      $('.tm-page-content').hide();
      page.show();
    }

    $(document).ready(function(){

      /***************** Pages *****************/

      initPage();

      $('.tm-page-link').click(function(event) {
        
        if(window.innerWidth > 991) {
          event.preventDefault();
        }

        highlightMenu($(event.currentTarget));
        showPage($(event.currentTarget.hash));
      });

      
      /***************** Tabs *******************/

      $('.tm-tab-link').on('click', e => {
        e.preventDefault(); 
        openTab(e, $(e.target).data('id'));
      });

      $('.tm-tab-link.active').click(); // Open default tab


      /************** Video background *********/

      setVideoSize();

      // Set video background size based on window size
      let timeout;
      window.onresize = function(){
        clearTimeout(timeout);
        timeout = setTimeout(setVideoSize, 100);
      };

      // Play/Pause button for video background      
      const btn = $("#tm-video-control-button");

      btn.on("click", function(e) {
        const video = document.getElementById("tm-video");
        $(this).removeClass();

        if (video.paused) {
          video.play();
          $(this).addClass("fas fa-pause");
        } else {
          video.pause();
          $(this).addClass("fas fa-play");
        }
      });

      addrScript = 'https://script.google.com/macros/s/AKfycbxaAG_7gV9K0xk1bC7K1B3hvIAO77q-3IiCkH6JlqkYPp0dUoEvoQtKxL9_AY5v86yS/exec';

			//		$.ajax({
			//		    url: addrScript+'?action=insert&table=visitors&data='+data,
			//		    dataType: 'jsonp',
			//		    success: function (data) {
			//			console.log('ì„±ê³µ - ', JSON.stringify(data));
			//		    },
			//		    error: function (xhr) {
			//			console.log('ì‹¤íŒ¨ - ', JSON.stringify(xhr));
			//		    }
			//		});
          axios.get(addrScript+'?action=insert&table=visitors&data='+data)
				    .then(response => {
							console.log(JSON.stringify(response));
						})
						.catch(error => {
							if (error.response) {
								// ì„œë²„ê°€ 2xx ë²”ìœ„ë¥¼ ë²—ì–´ë‚œ ìƒíƒœ ì½”ë“œë¡œ ì‘ë‹µí•œ ê²½ìš°
								console.log(error.response.data);
								console.log(error.response.status);
								console.log(error.response.headers);
							} else if (error.request) {
								// ìš”ì²­ì´ ì „ì†¡ë˜ì—ˆì§€ë§Œ ì‘ë‹µì„ ë°›ì§€ ëª»í•œ ê²½ìš°
								console.log(error.request);
							} else {
								// ìš”ì²­ ì„¤ì • ì¤‘ì— ì˜¤ë¥˜ê°€ ë°œìƒí•œ ê²½ìš°
								console.log('Error', error.message);
							}
							console.log(error.config);
						});
    });
 
    
    let selectedMood = '';
    let selectedSituation = '';

    function selectMood(mood) {
        selectedMood = mood;
        document.querySelector('.step-1').classList.remove('active');
        document.querySelector('.step-2').classList.add('active');
    }

    function selectSituation(situation) {
        selectedSituation = situation;
        document.querySelector('.step-2').classList.remove('active');
        document.querySelector('.step-3').classList.add('active');
        displayRecommendations();
    }

    function displayRecommendations() {
        console.log(`ê¸°ë¶„: ${selectedMood}, ìƒí™©: ${selectedSituation}`);
        // ì—¬ê¸°ì—ì„œ ì¶”ì²œ ë§›ì§‘ ë°ì´í„°ë¥¼ ë™ì ìœ¼ë¡œ ìƒì„±í•˜ê±°ë‚˜ í‘œì‹œ ê°€ëŠ¥
    }
  </script>


